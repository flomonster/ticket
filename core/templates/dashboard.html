{% extends "base.html" %}

{% block title %}
{{ asso.name }}
{% endblock %}

{% block content %}
    <div class="row">
        <div class="btn-group" role="group" style="margin-bottom: 1%">
            <button type="button" class="btn btn-primary" data-toggle="modal"
                    data-target="#addModal">
                Ajouter membre
            </button>
            <button type="button" class="btn btn-primary" data-toggle="modal"
                    data-target="#removeModal">
                Supprimer membre
            </button>
        </div>
    </div>



    <div class="panels container">
        <!-- Office members -->
        <div class="row">

            <div class="col-md-4">
                <div class="card panel" id="panel-asso-office">
                <div class="card-header">
                    Bureau
                    <button type="button" class="btn btn-info btn-xs"
                            data-toggle="modal" data-target="#officeModal">
                        &#x2795;
                    </button>
                </div>

                {% if not office %}
                    <div class="card-body">Aucun membre de bureau</div>
                {% else %}
                    <table class="table table-sm table-striped panel-body">
                        {% for member in office %}
                            <tr>
                                <td>
                                    {% if member.role == 3 %}
                                        &#9819;
                                    {% endif %}
                                </td>
                                <td>
                                    {{ member.member.username }}
                                </td>

                                <td>
                                    <button type="button"
                                            class="btn btn-danger btn-xs"
                                            onclick="window.location.href='{% url 'core:association_remove' asso.name member.member.username %}'">
                                        &#x2715;
                                    </button>
                                </td>
                            </tr>
                        {% endfor %}
                    </table>
                {% endif %}
            </div>
            </div>

            <div class="col-md-6">
                <div class="card panel card-info" id="panel-asso-events">
                    <div class="card-header">
                        Evénements
                        <a class="btn btn-primary" href="{% url 'core:event_create' %}">+</a>
                    </div>

                    {% if not events %}
                        <div class="card-body">Aucun évènement prévu</div>
                    {% else %}
                        <table class="table table-condensed table-sm card-body">
                            <thead>
                            <tr>
                                <th>Nom</th>
                                <th>Statut</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for event in events %}
                                {% if event.status != 5 %}
                                    <tr>
                                        <td>
                                            <a class="event-link" href="{% url 'core:event' event.id %}">{{ event.title }}</a>
                                        </td>

                                        <td>
                                            {% include 'event_status.html' %}
                                        </td>

                                        <td>
                                            {% if event.status == 1 %}
                                                {% if respo %}
                                                    {% if not event.respo %}
                                                        {% include 'validation.html' %}
                                                    {% endif %}
                                                {% elif pres %}
                                                    {% if not event.pres %}
                                                        {% include 'validation.html' %}
                                                    {% endif %}
                                                {% endif %}
                                            {% endif %}
                                        </td>

                                        <td>
                                          <form action="{% url 'core:register' event.id %}">
                                            <button class="btn btn-primary btn-sm" type="submit">S'inscrire</button>
                                          </form>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    {% endif %}
                </div>
            </div>
        </div>

    </div>

    {% include "modal_form.html" with form=office_form action="Ajouter" desc="Ajouter un membre au bureau" id="officeModal" %}
    {% include "modal_form.html" with form=add_form action="Ajouter" desc="Ajouter un membre" id="addModal" %}
    {% include "modal_form.html" with form=remove_form action="Supprimer" desc="Supprimer un membre" id="removeModal" %}
    <img href="{{ asso.logo }}"/>
{% endblock %}
